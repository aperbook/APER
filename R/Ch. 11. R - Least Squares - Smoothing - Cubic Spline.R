# SMOOTHING
# Using a cubic smoothing spline

# Enter the components of the y vector which is to be smoothed:

y <- c(-1.43019, 6.04592, 9.58303, 1.54254, -0.88694, 4.06973, 9.17304, 1.13495, 7.45699, 15.74484, 1.12558, 17.15696, 6.88679, 11.09317, 11.52492, 
       0.7562, 16.01558, 18.3268, 16.50272, 19.11229, 18.99143, 15.02593, 24.38673, 28.14986, 23.76151, 30.31275, 25.26124, 25.77407, 23.8333, 
       38.39684, 35.84262, 42.44692, 54.02955, 53.50813, 64.79849, 59.24174, 77.20558, 73.93601, 87.29376, 88.08443, 95.94978, 103.54804, 112.77473, 
       111.63895, 118.53408, 125.9284, 118.81328, 141.15881, 135.20524, 142.99198, 140.18448, 142.21834, 139.87201, 145.92058, 132.24247, 129.16746, 
       126.17106, 121.01135, 127.12175, 117.34638, 120.93793, 100.86413, 103.97118, 95.93294, 97.32407, 84.35673, 80.16229, 81.45964, 79.40157, 
       73.0108, 66.45519, 76.64956, 64.70356, 70.37581, 57.84236, 61.99477, 64.41442, 59.56763, 54.92255, 61.54357, 56.23101, 55.58138, 66.73986, 
       72.86224, 59.59617, 55.289, 60.18855, 73.56593, 66.03791, 57.88113, 66.30424, 63.63619, 63.60979, 64.63644, 64.86713, 71.90526, 73.50744, 
       67.38007, 61.37389, 72.82759, 70.49247, 80.67177, 74.03304, 71.60054, 68.46447, 66.498, 69.88162, 73.42753, 69.47429, 69.36311, 79.91432, 
       71.04645, 74.82294, 72.05878, 75.20429, 77.27253, 74.46092, 78.21497, 86.14184, 74.32031, 82.56802, 74.92781, 68.94565, 78.54761, 80.69797, 
       75.37979, 82.0282, 80.83746, 76.07314, 84.56298, 81.61885, 72.96379, 82.94352, 77.40962, 71.47616, 80.44025, 79.47545, 86.74837, 73.78326, 
       75.85145, 79.83559, 86.35347, 81.36659, 78.77747, 76.81972, 79.19516, 83.25518, 74.94654, 84.39219, 79.50725, 82.32146, 83.33967, 
       81.50585, 86.03054, 86.47577, 78.45215, 75.71483, 81.70891, 76.83457, 87.90085, 85.29229, 79.00799, 87.19132, 77.48054, 84.77011, 74.65677, 
       85.31548, 78.29124, 72.70555, 82.99602, 78.654, 85.12341, 78.1603, 81.72557, 93.69654, 75.75145, 82.07499, 77.66242, 91.45572, 89.55738, 
       88.51722, 83.17604, 95.75362, 89.34707, 79.8447, 78.27853, 87.98271, 81.15726, 79.37566, 86.45409, 80.75983, 79.88028, 79.32639, 90.23407, 
       81.87034, 75.90812, 89.37784, 83.67599, 77.00079, 83.65553)

x  <- seq(1, length(y), len = 201)

# The scatter plot is drawn:

s02  <- smooth.spline(y, spar = 0.2)
plot(y, pch = 20, cex = 0.5, xlab = "x", ylab = "y", xlim=c(0, 200), ylim=c(0, 200), col.main = 2)
 
# The smoothed curve is drawn:
  
lines(predict(s02, x), col="red")
